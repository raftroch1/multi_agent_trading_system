# CLAUDE CODING GUIDELINES - SPY TRADING SYSTEM

## ğŸš« MANDATORY APPROVAL REQUIRED
**DO NOT CREATE OR MODIFY FILES WITHOUT FOLLOWING THESE GUIDELINES**

## ğŸ“ PROJECT ARCHITECTURE (Clean Architecture)

```
spy-trading-system-enhanced/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/           # Orchestration layer
â”‚   â”‚   â”œâ”€â”€ trading-controller.ts
â”‚   â”‚   â”œâ”€â”€ signal-controller.ts
â”‚   â”‚   â””â”€â”€ position-controller.ts
â”‚   â”œâ”€â”€ agents/               # Market analysis (KEEP ALL)
â”‚   â”‚   â”œâ”€â”€ multi-agent-market-analysis.ts
â”‚   â”‚   â”œâ”€â”€ order-flow-agent.ts
â”‚   â”‚   â”œâ”€â”€ volume-profile-enhanced.ts
â”‚   â”‚   â””â”€â”€ [all existing agents]
â”‚   â”œâ”€â”€ services/             # External integrations
â”‚   â”‚   â”œâ”€â”€ alpaca/
â”‚   â”‚   â”‚   â”œâ”€â”€ alpaca-client.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ alpaca-paper-trading.ts
â”‚   â”‚   â”‚   â””â”€â”€ alpaca-streaming.ts
â”‚   â”‚   â””â”€â”€ market-data/
â”‚   â”‚       â”œâ”€â”€ data-feed.ts
â”‚   â”‚       â””â”€â”€ options-feed.ts
â”‚   â”œâ”€â”€ strategies/           # Trading strategies
â”‚   â”‚   â”œâ”€â”€ naked-options/
â”‚   â”‚   â”‚   â”œâ”€â”€ naked-options-executor.ts
â”‚   â”‚   â”‚   â””â”€â”€ strike-selector.ts
â”‚   â”‚   â””â”€â”€ position-management/
â”‚   â”‚       â”œâ”€â”€ dynamic-profit-manager.ts
â”‚   â”‚       â”œâ”€â”€ enhanced-strike-selector.ts
â”‚   â”‚       â””â”€â”€ position-orchestrator.ts
â”‚   â”œâ”€â”€ utils/                # Shared utilities
â”‚   â”‚   â”œâ”€â”€ technical-indicators.ts
â”‚   â”‚   â”œâ”€â”€ greeks-engine.ts
â”‚   â”‚   â””â”€â”€ transaction-cost-engine.ts
â”‚   â”œâ”€â”€ types/                # Type definitions
â”‚   â”‚   â”œâ”€â”€ index.ts          # Export all types
â”‚   â”‚   â”œâ”€â”€ trading.types.ts
â”‚   â”‚   â”œâ”€â”€ market.types.ts
â”‚   â”‚   â””â”€â”€ alpaca.types.ts
â”‚   â””â”€â”€ config/               # Configuration
â”‚       â”œâ”€â”€ app.config.ts
â”‚       â”œâ”€â”€ alpaca.config.ts
â”‚       â””â”€â”€ trading.config.ts
â”œâ”€â”€ tests/                    # Test files
â”œâ”€â”€ docs/                     # Documentation
â”œâ”€â”€ scripts/                  # Build/deployment scripts
â”œâ”€â”€ index.ts                  # Main entry point
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

## ğŸ¯ PROJECT SCOPE
- **TARGET**: 0-DTE SPY naked options (calls/puts only)
- **GOAL**: $300/day on $25K account (1.2% return)
- **STRATEGY**: Multi-agent consensus + simple execution
- **BROKER**: Alpaca paper trading integration

## ğŸ“‹ CODING STANDARDS

### 1. BEFORE CREATING FILES:
- [ ] Check if similar functionality exists in existing files
- [ ] Verify file placement in correct folder
- [ ] Ensure dependency direction is correct (no circular imports)
- [ ] Document purpose in Memory Keeper

### 2. FILE NAMING:
- Files: kebab-case (trading-controller.ts)
- Classes: PascalCase (TradingController)
- Methods: camelCase (executeBuyCall)
- Constants: UPPER_SNAKE_CASE (MAX_POSITIONS)
- Interfaces: PascalCase (ITradingSignal)

### 3. DEPENDENCY RULES:
- Controllers can depend on Services and Agents
- Services can depend on Utils and Types
- Agents can depend on Utils and Types
- Utils can ONLY depend on Types
- NEVER: Utils â†’ Controllers, Agents â†’ Services

### 4. EXISTING FILES TO PRESERVE:
âœ… **KEEP ALL AGENTS**: Your sophisticated multi-agent system
âœ… **KEEP POSITION MANAGERS**: DynamicProfitManager, EnhancedStrikeSelector
âœ… **KEEP UTILITIES**: TechnicalIndicators, GreeksEngine
âœ… **KEEP TYPES**: All existing type definitions

### 5. FILES TO MOVE:
- Move alpaca.ts â†’ src/services/alpaca/alpaca-client.ts
- Move existing agents â†’ src/agents/
- Move position managers â†’ src/strategies/position-management/
- Move utils â†’ src/utils/
- Move types â†’ src/types/

## ğŸš« FORBIDDEN ACTIONS:
- âŒ Creating duplicate functionality
- âŒ Modifying existing working agents
- âŒ Breaking existing imports
- âŒ Creating files without proper placement
- âŒ Ignoring error handling patterns
- âŒ Hardcoding configuration values
- âŒ MASS FILE OPERATIONS: Never move multiple files at once - move individually
- âŒ BULK RENAME OPERATIONS: Never use wildcards for critical file moves
- âŒ AUTOMATED REORGANIZATION: Always verify each file move individually

## âœ… REQUIRED APPROVALS:
Before any file creation/modification:
1. **Memory Keeper Check**: Document purpose and scope
2. **Architecture Review**: Verify correct placement
3. **Dependency Analysis**: Check import direction
4. **Existing Code Review**: Ensure no duplication
5. **BACKUP VERIFICATION**: Confirm backups exist before file operations
6. **INDIVIDUAL FILE OPERATIONS**: Move files one at a time, verifying each move

## ğŸ”§ SAFE FILE OPERATIONS:
- Use `cp` (copy) before `mv` (move) to verify operation
- Test file operations on non-critical files first
- Verify folder structure exists before moving files
- Check file permissions after operations
- Always keep original files until operation is verified

## ğŸ¯ SUCCESS METRICS:
- All existing functionality preserved
- Clean folder structure achieved
- Working Alpaca integration
- No circular dependencies
- Comprehensive error handling

---
**Remember: Your existing multi-agent system is sophisticated and excellent. Focus on integration, not replacement.**